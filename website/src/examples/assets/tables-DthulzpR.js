import{w as T,v as f,b as A,L as B,B as M,c as D,F as O,a as j,g as C}from"./styles-Di8iHUIQ.js";import{g as L}from"./getDialog-BJeKnhN2.js";function z({fields:a,data:s,onChange:t}){const r=document.createElement("div"),n=new T({name:Math.random().toString().substring(2),box:r,selectType:"cell",recordHeight:26,show:{columnMenu:!1,lineNumbers:!0},columns:F(a),records:v(s.rawVal,a)});return r.setAttribute("id","table"),new ResizeObserver(()=>n.refresh()).observe(r),n.onChange=e=>{if(!a[e.detail.column])return;const o=b[e.detail.column];n.records[e.detail.index][o]=e.detail.value.new,t&&t(m(n.records,a))},n.onDelete=e=>{e.detail.force=!0,e.onComplete=()=>{t&&t(m(n.records,a))}},n.onPaste=e=>{e.onComplete=()=>{n.mergeChanges(),t&&t(m(n.records,a))}},f.derive(()=>{n.records=v(s.val,a),n.refresh()}),r}const b="ABCDEFGHIJKLMNOPRST";function F(a){return b.split("").map(t=>({field:t,text:'<div style="text-align: center">'+t+"</div>",size:"90px",resizable:!0,sortable:!0,editable:{type:"text"}})).map(t=>{const r=a.find(n=>n.field===t.field);return r?{...t,...r}:t})}function v(a,s){const t=Array.isArray(a)?a:l(a,s),r=Array(50).fill(0).map((e,o)=>({recid:o})),n=b.split("");for(let e=0;e<t.length;e++)for(let o=0;o<t[e].length;o++)r[e][n[o]]=t[e][o];return r;function l(e,o){const i=new Map;return o.forEach(c=>i.set(c.field,c)),Object.keys(e).map(c=>[i.get(c).text,e[c]])}}function m(a,s){if(b.includes(s[0].field))return r(a,s);return n(a,s);function r(l,e){let o=[...Array(l.length)].map(()=>[...Array(e.length)]);const i=b.split("");for(let u=0;u<o.length;u++)for(let d=0;d<o[u].length;d++)o[u][d]=l[u][i[d]]??"";return o.slice(0,c(o)+1);function c(u){for(let d=u.length-1;d>=0;d--)if(u[d].some(E=>E!==""))return d}}function n(l,e){return Object.fromEntries(e.map(({field:o},i)=>[o,l[i].B]))}}function I({tables:a,onChange:s}){const t=document.createElement("div"),r=document.createElement("div"),n=[],l=new Map;a.forEach((i,c)=>{n.push({id:c,text:i.text}),l.set(c,z({fields:i.fields,data:i.data,onChange:o}))});const e=new A({box:r,name:"tabs",active:n[0].id,flow:"up",tabs:n});t.id="tables",r.id="tabs",t.append(l.values().next().value,r),e.onClick=i=>{t.firstChild.replaceWith(l.get(i.target))};function o(i){s&&s({table:e.active,data:i})}return t}const g=f.state([[0,0,0],[5,0,5],[10,0,0]]),w=new B(new M,new D),p=f.state([w]),h=new Map;h.set("polyline",{text:"Polyline",fields:[{field:"A",text:"X-coordinate",min:"25",editable:{type:"float"}},{field:"B",text:"Y-coordinate",editable:{type:"float"}},{field:"C",text:"Z-coordinate",editable:{type:"float"}}],data:g});const N=({data:a})=>g.val=a;f.derive(()=>{w.geometry.setAttribute("position",new O(g.val.flat(),3)),p.val=[...p.rawVal]});const y=f.state(""),x=f.state(void 0);f.derive(()=>{y.val==="Tables"&&(x.val=I({tables:h,onChange:N}))});document.body.append(j({clickedButton:y,buttons:["Tables"],sourceCode:"https://github.com/madil4/awatif/blob/main/examples/src/tables/main.ts",author:"https://www.linkedin.com/in/cal-mense/"}),L({dialogBody:x}),C({objects3D:p}));
